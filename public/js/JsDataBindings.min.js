"use strict";var JsDataBindings=function(){function e(e){this._map=new WeakMap,this._bindings=Object.create(null),this._values=Object.create(null),this._handlers=Object.create(null),this._listeners=Object.create(null),this._observer=void 0,void 0!==e&&this.indexDomElement(e)}function t(e,t){for(var s=0,o=t.length;s<o;s++){var u=t[s];"childList"===u.type?(function(e,t){for(var r=0,n=t.length;r<n;r++)if(e._map.has(t[r])){var i=e._map.get(t[r]);for(var s in i)!function(e,t){var r=e._bindings[t.source],n=r.indexOf(t);-1!==n&&r.splice(n,1);0===r.length&&delete e._bindings[t.source];t.event&&t.element.removeEventListener(t.event,a(e,t.source,t.target))}(e,i[s]);e._map.delete(t[r])}}(e,u.removedNodes),function(e,t){for(var n=0,a=t.length;n<a;n++)r(e,t[n])}(e,u.addedNodes)):"attributes"===u.type?function(e,t){var r=t.target;if(!e._map.has(r))return;var a=t.attributeName,i=(e._map.get(t.target),e._map.get(t.target)[a]);if(void 0===i)return;n(e,r,i.source,r[a])}(e,u):"characterData"===u.type&&function(e,t){if("#text"===t.target.nodeName){var r=t.target.parentNode;if(!e._map.has(r))return;var a=e._map.get(r).innerText;if(void 0===a||a.mode===i.OneWay)return;n(e,r,a.source,r[a.target])}}(e,u)}}function r(e,t){var r=function(e){var t=[],r=void 0;if(void 0===e.getAttribute||!(r=e.getAttribute(o)))return t;for(var n=r.split(","),a=0,i=n.length;a<i;a++){var s=n[a].match(u);s[1]&&t.push(s)}return t}(t),c=r.length;if(0!==c)for(var v=t.nodeName.toLowerCase(),l=0;l<c;l++)!function(e,t,r,o){var u=function(e,t,r){var n={element:e,source:t[1],mode:t[3]&&"-"!==t[3]?t[3]:function(e){switch(e){case"input":case"select":case"textarea":return i.TwoWay;default:return i.OneWay}}(r),target:t[4]?t[4]:function(e,t){switch(t){case"input":var r=e.type;return"checkbox"===r||"radiobutton"===r?"checked":"value";case"textarea":case"select":return"value";default:return"innerText"}}(e,r)},a=function(e,t,r){if("input"===t){var n=e.type;if(r===s.Checkbox&&("checkbox"===n||"radiobutton"===n))return"change";if(r===s.Input)return"input"}else{if("select"===t&&"value"===r)return"input";if("textarea"===t&&"value"===r)return"input"}return!1}(e,r,n.target);a&&(n.event=a);return n}(t,r,o);void 0===e._bindings[u.source]&&(e._bindings[u.source]=[]);void 0===e._values[u.source]?e._values[u.source]=t[u.target]:u.mode!==i.OneWayToSource&&(t[u.target]=e._values[u.source]);void 0===e[u.source]&&Object.defineProperty(e,u.source,{get:function(){return e._values[u.source]},set:function(t){return n(e,null,u.source,t)}});u.event&&t.addEventListener(u.event,a(e,u.source,u.target));e._bindings[u.source].push(u),function(e,t,r){var n=void 0;e._map.has(t)?void 0!==(n=e._map.get(t))[r.target]&&console.warn("binding overridden"):(n=Object.create(null),e._map.set(t,n));n[r.target]=r}(e,t,u)}(e,t,r[l],v)}function n(e,t,r,n){if(e._values[r]!==n){e._values[r]=n;for(var a=e._bindings[r],s=0,o=a.length;s<o;s++){var u=a[s];u!==t&&u.mode!==i.OneWayToSource&&(u.element[u.target]=n)}var c=e._listeners[r];if(void 0!==c)for(var v=0,l=c.length;v<l;v++)c[v](t,n)}}function a(e,t,r){return void 0===e._handlers[t]&&(e._handlers[t]=function(a){n(e,a.target,t,a.target[r])}),e._handlers[t]}var i={OneWay:"->",TwoWay:"<->",OneWayToSource:"<-",Default:"-"},s={Input:"value",Checkbox:"checked",Div:"innerText"},o="data-bindings",u=/^ *([\w-]+) *((<?->?) *(\w+)?)? *$/,c={childList:!0,subtree:!0,attributes:!0,characterData:!0};return e.prototype.indexDomElement=function(e){var n=this,a=e.getElementsByTagName("*");r(this,e);for(var i=0,s=a.length;i<s;i++)r(this,a[i]);void 0===this._observer&&(this._observer=new MutationObserver(function(e){return t(n,e)}),this._observer.observe(e,c))},e.prototype.onchanged=function(e,t){"string"==typeof e&&(e=[e]);for(var r=0,n=e.length;r<n;r++){var a=e[r];void 0===this._listeners[a]&&(this._listeners[a]=[]),this._listeners[a].push(t)}},e.prototype.detach=function(){this._observer&&(this._observer.disconnect(),this._observer=null);for(var e in this._bindings){var t=this._bindings[e];for(var r in t){var n=t[e][r];n.event&&n.element.removeEventListener(n.event,a(this,e))}delete this[e]}_map=new WeakMap,this._bindings=Object.create(null),this._values=Object.create(null),this._handlers=Object.create(null),this._listeners=Object.create(null)},e}();
//# sourceMappingURL=JsDataBindings.min.js.map